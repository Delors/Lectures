.. meta::
  :version: renaissance
  :author: Michael Eichberg
  :keywords: "IT Sicherheit", "Pentesting"
  :description lang=de: Grundlagen des Pentesting
  :id: lecture-sec-pentesting
  :first-slide: last-viewed
  :exercises-master-password: WirklichSchwierig!

.. include:: ../docutils.defs



Pentesting
==================================================

----

:Dozent: `Prof. Dr. Michael Eichberg <https://delors.github.io/cv/folien.de.rst.html>`__
:Kontakt: michael.eichberg@dhbw.de, Raum 149B
:Version: 1.0

.. supplemental::

    :Folien:

        |html-source|

        |pdf-source|

    :Fehler melden:
        https://github.com/Delors/delors.github.io/issues


.. class:: new-section

Einführung
----------------

.. TODO Threat Modeling mit STRIDE

Bedrohungen\ [#]_
-----------------------------------

.. class:: incremental-list

- Angriffsarten:

  .. class:: incremental-list

  - Ransomware
  - Wirtschaftsspionage
  - :eng:`Advanced Persistent Threats`
  - (Distributed) Denial of Service (DoS/DDoS)
  - Spam und Phishing

- Unterscheidung der Angreifer:

  .. class:: incremental-list

  - Hacker
  - Cracker („kriminelle Hacker“ oder Insider)
  - Script Kiddies

.. [#] [BSI_Bedrohungslage]_



Pentest(ing)\ [#]_
-------------------

.. class:: incremental-list

- Sicherheitstest von einzelnen Rechnern oder von Netzwerke jeglicher Größe.
- Prüft die Sicherheit von Systembestandteilen und Anwendungen.
- Durchführung mit Hilfe des Einsatzes von Mitteln und Methoden, um unautorisierten Zugriff zu erhalten.

  (D. h. mit Methoden, die auch Angreifer verwenden!)
- erfordert Kenntnisse der Zielsysteme und der Zielumgebung
- wesentliche Schritte:

  .. class:: incremental-list

  1. Planung und Informationssammlung
  2. Auswahl der passenden Methoden und Werkzeuge
  3. Durchführung
  4. :peripheral:`Analyse der Ergebnisse und Erstellung eines Berichts`

.. supplemental::

  Ein einfacher Scan nach Schwachstellen ist kein Pentest.

.. [#] Pentests machen nur Sinn, wenn ein IT Sicherheitskonzept existiert.



Ziele des Pentesting
----------------------

.. class:: incremental-list

- Identifikation von Schwachstellen:

  - technischer Natur
  - organisatorischer Natur
- Erhöhung der Sicherheit
- Zertifizierung der IT Sicherheit durch einen Dritten



.. class:: no-title center-content

Vorbereitet sein ist alles....
--------------------------------

.. warning::
    :class: font-size-200

    .. class:: parent-background-color

    .. epigraph::

        It wasn't raining when Noah built the ark.

        -- Howard Ruff


.. supplemental::

    Der erste Schritt ist es vorbereitet zu sein. Ein Angriff wird kommen und wird zu einem Sicherheitsproblem führen!



.. class:: center-content no-title

Momentaufnahme
----------------

.. container:: s-font-size-200

  Ein Pentest ist immer nur eine Momentaufnahme!



Arten von Pentests
-------------------

.. grid::

  .. cell:: black-background white padding-0-5em

    **Black-Box**

    .. class:: incremental-list

    - Keine Informationen über das Zielsystem
    - Informationsgewinnung ist Teil der Aufgabe
    - „Simuliert einen Cyberangriff“

  .. cell:: incremental padding-0-5em

    **White-Box**

    .. class:: incremental-list

    - Umfangreiche Informationen werden bereitgestellt
    - „Simuliert ggf. einen Insiderangriff“

.. container:: dhbw-gray-background white incremental padding-0-5em

  **Gray-Box**

  .. class:: incremental-list

  - Informationen, die ein normaler Nutzer sich erarbeiten kann, werden bereitgestellt
  - „Simuliert einen Cyberangriff“
  - ggf. besseres Kosten-Nutzen-Verhältnis


.. supplemental::

    **Nicht Teil dieser LV**

    - Pentests, die auf Social-Engineering basieren.

    - Red Team vs. Blue Team

      :Red Team: Experten, die ein System angreifen.
      :Blue Team: IT Security Experten eines Unternehmens, die ein System verteidigen und dabei von entsprechenden Beratern unterstützt werden.

      Ziel ist es, die Sicherheit des Systems zu erhöhen und festzustellen:

      1. ob bzw. wie lange es gedauert hat bis der Angriff erkannt wurde,
      2. wie lange es danach gedauert hat die Bedeutung des Angriffs einzuschätzen
      3. und wie lange es abschließend gedauert hat bis das System wiederhergestellt und gesichert war.

      Am Ende einer Übung müssen sich beide Teams austauschen, um den maximalen Lerneffekt zu erzielen!



Aufbau von Pentests nach BSI\ [#]_
------------------------------------

.. _Klassifikationsschema:

Klassifikationsschema des BSI:

.. class:: incremental-list

:Informationsbasis: Black-Box ↔︎ White-Box

:Aggressivität: passiv scannend (keine Ausnutzung von Schwachstellen) ↔︎ aggressiv (Ausnutzung von Schwachstellen)

:Umfang: Punktuelle Tests oder vollständige Tests

:Vorgehensweise: verdeckt oder offensichtlich

:Technik: Netzwerkzugang, physischer Zugang, Social Engineering

:Ausgangspunkt: von außen oder innen

.. [#] [BSI_Penetrationstests]_



.. class:: no-title center-content

Risiken
-------

.. attention::
    :class: width-100

    Pentests können zu Störungen der normalen IT Prozesse führen.

    .. supplemental::

      Technische Risiken:

      - DoS Attacken
      - Systemabstürze

.. attention::
    :class: width-100 incremental

    Pentester können auf unternehmenskritische Daten Zugriff erhalten.



.. class:: no-title center-content

Grenzen von klassischen Pentests
------------------------------------

.. warning::

  Advanced Persistent Threats (APT) sind schwer zu erkennen und klassische Pentests helfen nur bedingt.



.. class:: new-section transition-move-left

Rechtliche Aspekte
-------------------------------------



Computerkriminalität und Strafrecht
-------------------------------------

- Computerkriminalität nimmt immer mehr zu
- Schaffung neuer Straftatbestände zwecks Generalprävention bisher nicht erfolgreich
- Strafrechtliche Verfolgung von Computerkriminalität ist schwierig; Beweisführung ist aufwendig und schwierig



Rechtslage\ [#]_
------------------

.. class:: incremental-list  list-with-explanations

- „[...] sich unbefugten Zugang zu einem System zu verschaffen ist in Deutschland strafbar.“

  (D.h. Pentests ohne explizite Erlaubnis sind illegal!)
- Pentests verlangen explizite schriftliche Erlaubnis zwischen Auftraggeber und Auftragnehmer
- Ein Auftraggeber kann nur für Systeme Pentests vergeben, für die er die Verantwortung trägt
- Pentests sind gesetzlich nicht vorgeschrieben
- Pentests sind jedoch geeignet um nachzuweisen, dass gesetzliche Vorgaben in Hinblick auf die IT Sicherheit eingehalten werden

.. [#] Es handelt sich hierbei um keine Rechtsberatung!

.. supplemental::

  Beim Einsatz von Cloud-Diensten ist es wichtig, dass der Auftraggeber die Erlaubnis hat, einen Pentest durchzuführen.




Rechtliche Vorschriften und Pentests
-------------------------------------

Pentests sind geeignet, um ggf. *nachzuweisen*, dass die rechtlichen Anforderungen in den folgenden Bereichen eingehalten werden:

.. deck::

  .. card::

    - Handelsgesetzbuch (HGB)

      .. class:: incremental-list list-with-explanations

      - Bestimmungen zu internen Kontrollsystemen (Abschnitt 4 GoBS)
      - Bestimmungen zur Datensicherheit (Abschnitt 5 GoBS)

        Bestimmungen in Hinblick auf den Schutz vor Verlust und unberechtigte Veränderung


  .. card::

    - Gesetz zur Kontrolle und Transparenz im Unternehmensbereich (KonTraG)

      .. epigraph::

        Der Vorstand hat geeignete Maßnahmen zu treffen, insbesondere ein Überwachungssystem einzurichten, damit den Fortbestand der Gesellschaft gefährdende Entwicklungen früh erkannt werden.

        -- § 91 Abs 2 AktG

  .. card::

    - Kreditwesengesetz

      Nach § 44 Abs. 1 KWG kann der Themenbereich Internet-Sicherheit zum Gegenstand einer Prüfung gemacht werden, wenn Finanzdienstleistungen über das Internet zur Verfügung gestellt werden.

  .. card::

    - Bundesdatenschutzgesetz (BDSG)

      **Datenschutzaudit**\ [#]

      .. epigraph::

        Zur Verbesserung des Datenschutzes und der Datensicherheit können Anbieter von Datenverarbeitungssystemen und -programmen und Daten verarbeitende Stellen ihr Datenschutzkonzept sowie ihre technischen Einrichtungen durch unabhängige und zugelassene Gutachter prüfen und bewerten lassen sowie das Ergebnis der Prüfung veröffentlichen.


    .. [#] Vergleichbare Aussagen finden sich auch im Staatsvertrag für Mediendienste (MDStV)

  .. card::

    - Telekommunikationsgesetz (TKG)

      .. Ziel ist deswegen die Einhaltung des Fernmeldegeheimnisses.

      .. epigraph::

        Wer Telekommunikationsanlagen betreibt, die dem geschäftsmäßigen Erbringen von Telekommunikationsdiensten dienen, hat bei den zu diesem Zwecke betriebenen Telekommunikations- und Datenverarbeitungssystemen angemessene technische Vorkehrungen oder sonstige Maßnahmen zum Schutze [...]

        1. der [...]systeme gegen unerlaubte Zugriffe, [...]

        2. gegen äußere Angriffe [...] zu treffen

        -- 87 Abs. 1 TKG

.. supplemental::

  GoBS: Grundsätze ordnungsmäßiger DV-gestützter Buchführungssysteme
  AktG: Aktiengesetz



Pentests und strafrechtliche Vorschriften
--------------------------------------------

.. deck::

  .. card::

    - **Zugangskontrolldiensteschutzgesetz**

      *Verbot von gewerbsmäßigen Eingriffen zur Umgehung von Zugangskontrolldiensten*

      .. epigraph::

        Verboten sind 1.) die Herstellung, die Einfuhr und die Verbreitung von Umgehungsvorrichtungen zu gewerbsmäßigen Zwecken, 2.) der Besitz, die technische Einrichtung, die Wartung und der Austausch von Umgehungsvorrichtungen zu gewerbsmäßigen Zwecken, 3.) die Absatzförderung von Umgehungseinrichtungen.

        -- § 3 ZKDSG

  .. card::

    - **Telekommunikationsgesetz**

      Einsatz von Netzwerk-Sniffern und das Abhören von Netzwerkverkehr ist ggf. strafbar, wenn keine Erlaubnis eingeholt wurde.

  .. card::

    - **Betriebsverfassungsgesetz**

      Pentests sind ggf. dazu geeignet Überwachung und Leistungsbeurteilungen der Mitarbeiter (implizit oder explizit) durchzuführen. Eine Einbindung des Betriebsrats ist deswegen im Vorfeld erforderlich; auch wenn keine Intention oder Auswertung bzgl. Leistungsorientierung existiert!


.. attention::
    :class: incremental

    Der Auftragnehmer hat die allgemeine Sorgfaltspflicht!

    :peripheral:`(Wenn er „aus Versehen“, die falschen IP Adressen angreift, ist der Pentester schuldig.)`



Beauftragung von Pentests
--------------------------------

.. class:: incremental-list

- typischerweise handelt es sich um *eine entgeltliche Geschäftsbesorgung mit Dienstleistungscharakter*

- Vertragsgegenstand:

  - Zielsetzung (z. B. Identifikation von Schwachstellen, Erlangung einer Zertifizierung, Erhöhung der technischen Sicherheit)
  - Art des Pentests (z. B. siehe Klassifikationsschema_)
  - Einzusetzende und auszuschließende Methoden
  - Aufwand (z. B. in Personentage) und Umfang bzw. Zeitraum in dem die Tests durchgeführt werden.
- ggf. durchführende Personen benennen (insb. bei Social-Engineering-Pentests)
- nur ein vertretungsberechtigter des Auftraggebers (z. B. Prokurist, Geschäftsführer) kann den Vertrag wirksam abschließen

.. supplemental::

  Der Aufwand muss nicht deckungsgleich mit dem Zeitraum sein. Insbesondere wenn umfangreiche, automatisierte Scans eingesetzte werden, kann der Zeitraum sehr viel länger sein.



.. class:: transition-fade

Referenzen
--------------

- .. [BSI_Penetrationstests] `BSI Penetrationstests 2020 <https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/Studien/Penetrationstest/penetrationstest.pdf?__blob=publicationFile&v=3>`__

- .. [BSI_Bedrohungslage] `BSI Lagebericht 2023 <https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/Lageberichte/Lagebericht2023.pdf?__blob=publicationFile&v=8>`__
